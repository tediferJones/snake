function B(E,F,H){const I=document.createElement(E);if(F)Object.keys(F).forEach((j)=>I[j]=F[j]);if(H?.length)I.append(...H.filter((j)=>j!=null));return I}var J,L;document.addEventListener("keydown",(E)=>{console.log(E.key,L);const F=E.key;if(!J||J.readyState>1)return;const H=["ArrowUp","ArrowDown"],I=["ArrowRight","ArrowLeft"];if(L){const j=L.players[L.uuid].dir;if(console.log("current player dir",j),H.includes(F)&&H.includes(j))return console.log("ignore vertical move");if(I.includes(F)&&I.includes(j))return console.log("ignore horizontal move")}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(E.key))J?.send(E.key)});document.body.append(B("button",{textContent:"Join General Lobby",className:"m-4 p-4 border-4 border-black",onclick:()=>{const{host:E,protocol:F}=window.location,H=document.querySelector("#colorPicker").value.slice(1);console.log(H),J=new WebSocket(`${F==="http:"?"ws":"wss"}://${E}?gameCode=general&color=${H}`),J.onmessage=(I)=>{const j=JSON.parse(I.data);L=j,document.querySelector("#gameOver").textContent="",document.querySelector("#board")?.remove(),document.body.appendChild(B("div",{id:"board",className:"mx-auto w-min border-4 border-black flex flex-col bg-gray-200"},[...Array(j.boardSize).keys()].map((A)=>{return B("div",{className:"flex"},[...Array(j.boardSize).keys()].map((N)=>{return B("div",{id:`cell-${A}-${N}`,className:"aspect-square min-h-12 flex justify-center items-center border-2 border-gray-300"})}))}))),Object.values(j.players).forEach((A)=>{if(A.state!=="playing"){if(A.uuid===j.uuid)document.querySelector("#gameOver").textContent=A.state;return}const{pos:N,color:Q}=A;N.forEach((P)=>{document.querySelector(`#cell-${P.row}-${P.col}`).style.backgroundColor=`#${Q}`})}),j.foodLocations.forEach((A)=>{document.querySelector(`#cell-${A.row}-${A.col}`).textContent="*"})}}}),B("input",{id:"colorPicker",type:"color",value:"#"+[...Array(6).keys()].map(()=>Math.floor(Math.random()*16).toString(16)).join("")}),B("button",{textContent:"Disconnect",className:"m-4 p-4 border-4 border-black",onclick:()=>J?.close()}),B("span",{id:"gameOver"}));
